<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Nima Masoudvaziri, Zolal Ayazpour" />


<title>COPMARISON OF DIFFERENT CLIMATE DATASETS</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="site_libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="site_libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="site_libs/dygraphs-1.1.1/shapes.js"></script>
<script src="site_libs/moment-2.8.4/moment.js"></script>
<script src="site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="site_libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Data Science Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">COPMARISON OF DIFFERENT CLIMATE DATASETS</h1>
<h4 class="author">Nima Masoudvaziri, Zolal Ayazpour</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>When studying atmospheric-related phenomena, one may use observations (like data from weather stations) or simulated datasets based on numerical models. Also, one may want to investigate and explore a phenomenon or behavior which has happened already in the past, or may be interested in prediction of an event or behavior. As a result, different datasets should be incorporated given the nature of the study. Essentially, there are three types of models: Forecast, Analysis and Reanalysis. Forecast models are comprised of physics-based equations and propogate an atmospheric state forward in time, i.e. given the vaules of different parameters at time t, one can calculate the values for time t+dt. Analysis basically does the same thing, however instead of the prediction by physics, it takes place by statistical methods. In other words, given the observations at some locations, one can come up with an estimation for different parameters at locations that there is no observation available. There are different physics-based models and also different assumptions and methodologies in data assimilation, which experience modifications along the time. Besides, instrumnetation also changes as time passes and technology improves. Reanalysis takes all these variations into account and yield a comprehensive and coherent dataset over the globe. It is supposedly the best dataset for looking into the past weather. More infomation can be found <a href="https://rda.ucar.edu/datasets/ds083.2/docs/Analysis.pdf">here</a>.</p>
</div>
<div id="definition-of-the-problem" class="section level1">
<h1>Definition of the Problem</h1>
<p>For this study, among different publicly available models, two will be considered. The main objective of the work is to compare their dataset for some primary climatological variables (precipitation, temperature, wind, snow), within both temporal and spatial scopes. One of the models is called High Resolution Rapid Refresh (HRRR) which is a forecast model (with forecast length of 18 hours) generating data to a 3-km resolution grid, hourly. More information about HRRR can be find <a href="http://home.chpc.utah.edu/~u0553130/Brian_Blaylock/hrrr_FAQ.html">here</a>. The other model to use is ERA5 which is a climate reanlysis dataset of up to 3 month before with 30-km resolution at an hourly frequency. More information about ERA5 dataset can be found <a href="https://confluence.ecmwf.int/display/CKB/ERA5">here</a>. Summry of the models are provided in the following table.</p>
<table>
<thead>
<tr class="header">
<th>Model</th>
<th>Type</th>
<th>Resolution</th>
<th>Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>HRRR</strong></td>
<td>forecast</td>
<td>3 km</td>
<td>hourly</td>
</tr>
<tr class="even">
<td><strong>ERA5</strong></td>
<td>reanlaysis</td>
<td>30 km</td>
<td>hourly</td>
</tr>
</tbody>
</table>
<p>The main reason for choosing these two models is that one of them has a significantly higher resolution and, on the other hand, the other is supposedly based on a more powerful model.</p>
</div>
<div id="materials-and-methods" class="section level1">
<h1>Materials and methods</h1>
<div id="materials" class="section level3">
<h3>Materials</h3>
<p>Each model has its own archive and support, accessible by public. HRRR data can be found following <a href="http://home.chpc.utah.edu/~u0553130/Brian_Blaylock/cgi-bin/hrrr_download.cgi">this instruction</a>, and ERA5 can be downloaded following <a href="https://confluence.ecmwf.int/display/CKB/How+to+download+ERA5">this instruction</a>. Also, observations from weather stations can be found from <a href="https://www.ncdc.noaa.gov/cdo-web/datatools/lcd">NOAA LCD Tool</a>.</p>
</div>
<div id="methods" class="section level3">
<h3>Methods</h3>
<p>The output of HRRR and ERA5 are summarized in GRIB2 and NetCDF formats, respectively. Considering the State of New York as the case study, the output of both models are loaded in the working directory for one year. They are meteorological datasets, including precipitation, temperature, wind, and snow, which are mapped at specific grid cells. Using the raster package, the output dataset of both models can be read. Dealing with the spatial dataset, in addition to raster package, sf and sp packages are also useful to manage the data. In order to compare two models, first, the output dataset of each model needs to be mapped over the same grid cells. As a result, two raster objects will be produced to project values of meteorological parameters on the same grid cells. In the next step, the hourly dataset will be aggregated to produce data at daily and monthly resolution, and their statistical characteristics are calculated and plotted applying ggplot2. In this study, the output of both models will be visualized for each meteorological parameter over the year 2018 as a gif using gganimate package to provide a general understanding of the models’ outputs. Furthermore, the difference between both datasets will be investigated by mapping the difference over the case study and visualizing the result as new plots. In addition, the temporal difference behavior between these two models will be studied by plotting both dataset as time series over two years.</p>
</div>
<div id="packages" class="section level3">
<h3>Packages</h3>
<p>Here is the required packages for this project.</p>
<pre class="r"><code>library(raster)     # managing rasters
library(rgdal)      # managing rasters
library(sf)         # managing rasters
library(lubridate)  # managing date formats
library(dplyr)      # managing data
library(ggplot2)    # plots
library(ggpubr)     # plots
library(rasterVis)  # plots
library(viridisLite)# plots
library(xts)        # timeseries plots
library(dygraphs)   # timeseries plots
library(gridExtra)  # timeseries plots
library(rnoaa)      # NOAA data
library(png)        # load png


knitr::opts_chunk$set(cache=TRUE)  # cache the results for quick compiling</code></pre>
</div>
<div id="preprocessing" class="section level2">
<h2>Preprocessing</h2>
<p>The following code loads the ERA5 data and preprocesses them, creating the rasters and dataframes that we need for visualization and analysis. Each file of this dataset contains 24 rasters (correponding to 24 hours of a day) for the variable that you specify. User should input the year, name of the variable, coordinates of the weather station and directory of the files.</p>
<pre class="r"><code>runn=F
if(runn){
  Yr&lt;- 2018
  par&lt;- &#39;skt&#39;     # the variable you are interested in,
                  # and you have it available on your disk
  
  xy= cbind(-78.7358, 42.9408)  # Coordinates of the weather station
                                # this is Buffalo&#39;s Niagara International Airport

  # This data frame will be used for time-series plots
  daily_df= data.frame(Date= as.Date(character()),
                       Mean= numeric(),
                       Min= numeric(),
                       Max= numeric(),
                       stringsAsFactors = FALSE)
  monthly_bricks= list()
  monthly_mean= list()
  monthly_min= list()
  monthly_max= list()

  for(y in c(Yr)){
    for(M in 1:12){
      month_path= paste0(&#39;PATH TO THE FILES&#39;,&#39;/Y&#39;,Yr,&#39;/M&#39;,
                         sprintf(&quot;%02d&quot;, as.numeric(M)),&#39;/&#39;)
      ls= list.files(month_path, recursive = TRUE)
      l= length(ls)
      n= nrow(daily_df)
      everyday_bricks= list()
    
    
    for(i in c(1:l)){
      f_name= paste0(month_path,ls[i])
      day_brick= brick(f_name, varname= par)
      daily_df[n+i,1]= as.Date(substr(f_name,nchar(f_name)-10,nchar(f_name)-3), &quot;%Y%m%d&quot;)
      daily_df[n+i,2]= extract(calc(day_brick, mean), xy, method=&#39;simple&#39;)
      daily_df[n+i,3]= extract(calc(day_brick, min), xy, method=&#39;simple&#39;)
      daily_df[n+i,4]= extract(calc(day_brick, max), xy, method=&#39;simple&#39;)
      
      everyday_bricks[i]= day_brick
    }
    # Rasters below will be used to generate maps.
    monthly_bricks[M]= brick(everyday_bricks)
    monthly_mean[M]= calc(monthly_bricks[[M]],mean)
    monthly_min[M]= calc(monthly_bricks[[M]],min)
    monthly_max[M]= calc(monthly_bricks[[M]],max)
    }
  }
}</code></pre>
<p>The following code loads the HRRR data and preprocesses them, creating the rasters and dataframes that we need for visualization and analysis. Each file of this dataset contains a raster (correponding to an hour of a day) for the variable that you specify. Again, user should input the year, name of the variable, coordinates of the weather station and directory of the files.</p>
<pre class="r"><code>img &lt;- readPNG(&quot;./Data/Framework.png&quot;)
grid::grid.raster(img)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<pre class="r"><code>runn=F
if(runn){
  Yr&lt;- 2018
  par&lt;- &#39;TMP_surface&#39;     # the variable you are interested in,
                          # and you have it available on your disk
  
  xy= cbind(-78.7358, 42.9408)  # Coordinates of the weather station
                                # this is Buffalo&#39;s Niagara International Airport
  
  ny &lt;- extent(-81, -70, 39.5, 46) # bounding box of the New York State

  # This data frame will be used for time-series plots
  for(Y in c(Yr)){
    daily_df= data.frame(Date= as.Date(character()),
                        Mean= numeric(),
                        Min= numeric(),
                        Max= numeric(),
                        stringsAsFactors = FALSE)
    monthly_bricks= list()
    monthly_mean= list()
    monthly_min= list()
    monthly_max= list()
  
    for(M in c(1:12)){
      data_path= paste0(getwd(),&#39;/&#39;)
      month_path=paste0(&#39;HRRRfromPando_&#39;,Y,sprintf(&quot;%02d&quot;, as.numeric(M)))
      par_path=paste0(par)
      ls= list.files(data_path,month_path)
      ls=ls[grep(par_path,ls)]
      l= length(ls)/24  
      n= nrow(daily_df)
      everyday_bricks=list()
    
      for(D in c(1:l)){
        day_path=paste0(month_path,sprintf(&quot;%02d&quot;, as.numeric(D)))
        ls_day= ls[grepl(day_path,ls)]
        l_hr=length(ls_day)
        day_list=list()     
      
        for(hr in c(1:l_hr)){
          file_path=paste0(data_path,ls_day[hr])
          day_list[hr]=try(raster(file_path),silent=TRUE)
        }
      
        for(fn in day_list){
          if (is.character(fn)){
            day_list[which(day_list==fn)]=NULL
          }
        }
    
      day_brick=brick(day_list)
      
      f_name= paste0(day_path)
      
      daily_df[n+D,1]= as.Date(substr(f_name,nchar(f_name)-7,nchar(f_name)), &quot;%Y%m%d&quot;)
      daily_df[n+D,2]= extract(calc(day_brick, mean), xy, method=&#39;simple&#39;)
      daily_df[n+D,3]= extract(calc(day_brick, min), xy, method=&#39;simple&#39;)
      daily_df[n+D,4]= extract(calc(day_brick, max), xy, method=&#39;simple&#39;)
      
      everyday_bricks[D]= day_brick
      }
      
      # Rasters below will be used to generate maps.
      monthly_bricks[M]= brick(everyday_bricks)
      monthly_mean[M]= crop(projectRaster(
        calc(monthly_bricks[[M]],mean),crs=&quot;+proj=longlat +datum=WGS84 +ellps=WGS84
        +towgs84=0,0,0&quot;), ny)
      monthly_min[M]= crop(projectRaster(
        calc(monthly_bricks[[M]],min),crs=&quot;+proj=longlat +datum=WGS84 +ellps=WGS84
        +towgs84=0,0,0&quot;), ny)
      monthly_max[M]= crop(projectRaster(
        calc(monthly_bricks[[M]],max),crs=&quot;+proj=longlat +datum=WGS84 +ellps=WGS84
        +towgs84=0,0,0&quot;), ny)
    }
  }
}</code></pre>
<div id="visualiziation-of-hrrr-and-era5" class="section level3">
<h3>Visualiziation of HRRR and ERA5</h3>
<pre class="r"><code>us &lt;- st_read(&quot;./Data/tl_2017_us_state/tl_2017_us_state.shp&quot;)

ny_bound &lt;- us %&gt;% 
  filter(STUSPS==&quot;NY&quot;)

#Raster
monthly_mean_ERA5= list()
monthly_min_ERA5= list()
monthly_max_ERA5= list()
monthly_mean_HRRR= list()
monthly_min_HRRR= list()
monthly_max_HRRR= list()
monthly_mean_HRRR_resample=list()
monthly_min_HRRR_resample=list()
monthly_max_HRRR_resample=list()
monthly_mean_Diff=list()
monthly_min_Diff=list()
monthly_max_Diff=list()

for (M in c(1:12)){
  monthly_mean_ERA5[M] = raster(paste0(getwd(),&#39;/Data/monthly_mean_ERA5_&#39;,M,&#39;.tif&#39;))
  offs(monthly_mean_ERA5[[M]])=-273.15
  monthly_min_ERA5[M] = raster(paste0(getwd(),&#39;/Data/monthly_min_ERA5_&#39;,M,&#39;.tif&#39;))
  offs(monthly_min_ERA5[[M]])=-273.15
  monthly_max_ERA5[M] = raster(paste0(getwd(),&#39;/Data/monthly_max_ERA5_&#39;,M,&#39;.tif&#39;))
  offs(monthly_max_ERA5[[M]])=-273.15
  
  monthly_mean_HRRR[M] = raster(paste0(getwd(),&#39;/Data/monthly_mean_HRRR_&#39;,M,&#39;.tif&#39;))
  monthly_min_HRRR[M] = raster(paste0(getwd(),&#39;/Data/monthly_min_HRRR_&#39;,M,&#39;.tif&#39;))
  monthly_max_HRRR[M] = raster(paste0(getwd(),&#39;/Data/monthly_max_HRRR_&#39;,M,&#39;.tif&#39;))
  
  monthly_mean_HRRR_resample[M] &lt;- resample(monthly_mean_HRRR[[M]],monthly_mean_ERA5[[M]],method=&quot;bilinear&quot;)
  monthly_min_HRRR_resample[M] &lt;- resample(monthly_min_HRRR[[M]],monthly_min_ERA5[[M]],method=&quot;bilinear&quot;)
  monthly_max_HRRR_resample[M] &lt;- resample(monthly_max_HRRR[[M]],monthly_max_ERA5[[M]],method=&quot;bilinear&quot;)
  
  monthly_mean_Diff[M] &lt;- monthly_mean_HRRR_resample[[M]]-monthly_mean_ERA5[[M]]
  monthly_min_Diff[M] &lt;- monthly_min_HRRR_resample[[M]]-monthly_min_ERA5[[M]]
  monthly_max_Diff[M] &lt;- monthly_max_HRRR_resample[[M]]-monthly_max_ERA5[[M]]
}

# comparing resolutions
# p1=gplot(mask(crop(monthly_mean_HRRR[[10]],extent(ny_bound)),ny_bound))+ 
#   geom_tile( aes( fill=value ) )+
#   scale_fill_continuous(type=&#39;viridis&#39;,name=&quot;Temperature&quot;)+
#   xlab(NULL)+
#   ylab(NULL)+
#   ggtitle(&#39;HRRR (3 km)&#39;)
p1&lt;- levelplot(mask(crop(monthly_mean_HRRR[[10]],extent(ny_bound)),ny_bound),
          col.regions=viridis, margin=F, main=list(&#39;HRRR (3 km)&#39;))

p2&lt;- levelplot(mask(crop(monthly_mean_ERA5[[10]],extent(ny_bound)),ny_bound),
          col.regions=viridis, margin=F, main=list(&#39;ERA5 (25 km)&#39;))

ggarrange(p1,p2,nrow=1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="960" /></p>
</div>
<div id="resample-from-fine-to-coarse-or-coarse-to-fine" class="section level3">
<h3>Resample from fine to coarse, or coarse to fine?</h3>
<pre class="r"><code># comparing resample methods (from fine to coarse and vise versa)
HRRR_to_ERA5_resample &lt;- resample(monthly_mean_HRRR[[10]],monthly_mean_ERA5[[10]],method=&quot;bilinear&quot;)
monthly_mean_Diff_1 &lt;- HRRR_to_ERA5_resample-monthly_mean_ERA5[[10]]

ERA5_to_HRRR_resample &lt;- resample(monthly_mean_ERA5[[10]],monthly_mean_HRRR[[10]],method=&quot;bilinear&quot;)
monthly_mean_Diff_2 &lt;- monthly_mean_HRRR[[10]]-ERA5_to_HRRR_resample

p1&lt;- levelplot(mask(crop(monthly_mean_Diff_1,extent(ny_bound)),ny_bound),
          col.regions=viridis, margin=F, main=list(&#39;Difference by resampled HRRR&#39;))

p2&lt;- levelplot(mask(crop(monthly_mean_Diff_2,extent(ny_bound)),ny_bound),
          col.regions=viridis, margin=F, main=list(&#39;Difference by resampled ERA5&#39;))

ggarrange(p1,p2,nrow=1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
</div>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<pre class="r"><code>HRRR_df &lt;- read.csv2(paste0(&#39;./Data/daily_df_HRRR.csv&#39;))
ERA5_df &lt;- read.csv2(paste0(&#39;./Data/daily_df_ERA5.csv&#39;)) %&gt;% 
  mutate(Mean=Mean-273.15,Min=Min-273.15,Max=Max-273.15)

station_df=meteo_tidy_ghcnd(&quot;USW00014733&quot;,
                            date_min = &quot;2018-01-01&quot;, 
                            date_max = &quot;2018-12-31&quot;, 
                            var = c(&quot;TMAX&quot;,&quot;TMIN&quot;,&quot;TAVG&quot;),
                            keep_flags=T) %&gt;% 
  select(c(2,12:14)) %&gt;% 
  mutate(tavg=tavg/10,tmin=tmin/10,tmax=tmax/10) %&gt;% 
  mutate(date=as.Date(date)) %&gt;% 
  select(c(1,2,4,3))

dfs&lt;- data.frame(Date=as.Date(0:364, origin=&#39;2018-01-01&#39;),
                 Mean=numeric(365),
                 Min=numeric(365),
                 Max=numeric(365))
for(i in 1:nrow(station_df)){
  dfs[i,2:4]=station_df[i,2:4]
}

p_h_avg &lt;- ggplot()+
  geom_line(data=HRRR_df, aes(x=as.Date(HRRR_df[,2]), y=HRRR_df[,3], color=&#39;HRRR&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,2], color=&#39;Station&#39;))+
  labs(title=&#39;Average Temperature: HRRR vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;firebrick&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;HRRR&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)

p_h_min &lt;- ggplot()+
  geom_line(data=HRRR_df, aes(x=as.Date(HRRR_df[,2]), y=HRRR_df[,4], color=&#39;HRRR&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,3], color=&#39;Station&#39;))+
  labs(title=&#39;Minimum Temperature: HRRR vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;firebrick&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;HRRR&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)
p_h_max &lt;- ggplot()+
  geom_line(data=HRRR_df, aes(x=as.Date(HRRR_df[,2]), y=HRRR_df[,5], color=&#39;HRRR&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,4], color=&#39;Station&#39;))+
  labs(title=&#39;Maximum Temperature: HRRR vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;firebrick&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;HRRR&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)

p_e_avg &lt;- ggplot()+
  geom_line(data=ERA5_df, aes(x=as.Date(ERA5_df[,2]), y=ERA5_df[,3], color=&#39;ERA5&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,2], color=&#39;Station&#39;))+
  labs(title=&#39;Average Temperature: ERA5 vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;limegreen&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;ERA5&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)
p_e_min &lt;- ggplot()+
  geom_line(data=ERA5_df, aes(x=as.Date(ERA5_df[,2]), y=ERA5_df[,4], color=&#39;ERA5&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,3], color=&#39;Station&#39;))+
  labs(title=&#39;Minimum Temperature: ERA5 vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;limegreen&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;ERA5&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)
p_e_max &lt;- ggplot()+
  geom_line(data=ERA5_df, aes(x=as.Date(ERA5_df[,2]), y=ERA5_df[,5], color=&#39;ERA5&#39;))+
  geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,4], color=&#39;Station&#39;))+
  labs(title=&#39;Maximum Temperature: ERA5 vs Weather Station&#39;,
       x=&#39;Date&#39;, y= &#39;Temperature [C]&#39;, colour=&#39;Data Source&#39;)+
  scale_color_manual(values= c(&#39;limegreen&#39;,&#39;royalblue&#39;),
                     labels = c(&quot;ERA5&quot;, &quot;Station&quot;),
                     guide = &quot;legend&quot;)

grid.arrange(p_h_avg,p_e_avg,
             p_h_min,p_e_min,
             p_h_max,p_e_max,
             nrow=3)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" width="960" /></p>
<pre class="r"><code># Plots&lt;- list()
# for(i in c(1:3)){
#   for(j in c(1:2)){
#     p = ggplot()+
#       geom_line(data=ls_df[[j]], aes(x=as.Date(ls_df[[j]][,2]), y=ls_df[[j]][,(i+2)]),
#                 color=ls_color[j])+
#       geom_line(data=dfs, aes(x=as.Date(dfs[,1]), y=dfs[,(i+1)]),
#                 color=ls_color[3])
#     Plots[[(i-1)*2+j]] = p
#     print((i-1)*2+j)
#   }
# }
# grid.arrange(grobs=Plots, nrow=3)</code></pre>
<pre class="r"><code>ts_mean&lt;- xts(cbind(station_df$date,HRRR_df$Mean,ERA5_df$Mean,station_df$tavg),
              order.by=station_df$date)

dygraph(ts_mean[,c(2:4)],main=&quot;Daily Average Temperature in Buffalo, NY&quot;) %&gt;%
  dySeries(&quot;V1&quot;,label=&quot;HRRR&quot;) %&gt;% 
  dySeries(&quot;V2&quot;,label=&quot;ERA5&quot;) %&gt;% 
  dySeries(&quot;V3&quot;,label=&quot;Weather Station&quot;) %&gt;% 
  dyRangeSelector(dateWindow=c(&quot;2018-01-01&quot;, &quot;2018-12-31&quot;)) %&gt;% 
  dyOptions(colors=c(&quot;indianred&quot;,&quot;mediumseagreen&quot;,&quot;royalblue&quot;))</code></pre>
<div id="htmlwidget-ea8142d7b975f70bb31e" style="width:768px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-ea8142d7b975f70bb31e">{"x":{"attrs":{"title":"Daily Average Temperature in Buffalo, NY","labels":["day","HRRR","ERA5","Weather Station"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"series":{"HRRR":{"axis":"y"},"ERA5":{"axis":"y"},"Weather Station":{"axis":"y"}},"showRangeSelector":true,"dateWindow":["2018-01-01T00:00:00.000Z","2018-12-31T00:00:00.000Z"],"rangeSelectorHeight":40,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel","stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colors":["indianred","mediumseagreen","royalblue"],"colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":true,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false},"scale":"daily","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2018-01-01T00:00:00.000Z","2018-01-02T00:00:00.000Z","2018-01-03T00:00:00.000Z","2018-01-04T00:00:00.000Z","2018-01-05T00:00:00.000Z","2018-01-06T00:00:00.000Z","2018-01-07T00:00:00.000Z","2018-01-08T00:00:00.000Z","2018-01-09T00:00:00.000Z","2018-01-10T00:00:00.000Z","2018-01-11T00:00:00.000Z","2018-01-12T00:00:00.000Z","2018-01-13T00:00:00.000Z","2018-01-14T00:00:00.000Z","2018-01-15T00:00:00.000Z","2018-01-16T00:00:00.000Z","2018-01-17T00:00:00.000Z","2018-01-18T00:00:00.000Z","2018-01-19T00:00:00.000Z","2018-01-20T00:00:00.000Z","2018-01-21T00:00:00.000Z","2018-01-22T00:00:00.000Z","2018-01-23T00:00:00.000Z","2018-01-24T00:00:00.000Z","2018-01-25T00:00:00.000Z","2018-01-26T00:00:00.000Z","2018-01-27T00:00:00.000Z","2018-01-28T00:00:00.000Z","2018-01-29T00:00:00.000Z","2018-01-30T00:00:00.000Z","2018-01-31T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-02-02T00:00:00.000Z","2018-02-03T00:00:00.000Z","2018-02-04T00:00:00.000Z","2018-02-05T00:00:00.000Z","2018-02-06T00:00:00.000Z","2018-02-07T00:00:00.000Z","2018-02-08T00:00:00.000Z","2018-02-09T00:00:00.000Z","2018-02-10T00:00:00.000Z","2018-02-11T00:00:00.000Z","2018-02-12T00:00:00.000Z","2018-02-13T00:00:00.000Z","2018-02-14T00:00:00.000Z","2018-02-15T00:00:00.000Z","2018-02-16T00:00:00.000Z","2018-02-17T00:00:00.000Z","2018-02-18T00:00:00.000Z","2018-02-19T00:00:00.000Z","2018-02-20T00:00:00.000Z","2018-02-21T00:00:00.000Z","2018-02-22T00:00:00.000Z","2018-02-23T00:00:00.000Z","2018-02-24T00:00:00.000Z","2018-02-25T00:00:00.000Z","2018-02-26T00:00:00.000Z","2018-02-27T00:00:00.000Z","2018-02-28T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-03-02T00:00:00.000Z","2018-03-03T00:00:00.000Z","2018-03-04T00:00:00.000Z","2018-03-05T00:00:00.000Z","2018-03-06T00:00:00.000Z","2018-03-07T00:00:00.000Z","2018-03-08T00:00:00.000Z","2018-03-09T00:00:00.000Z","2018-03-10T00:00:00.000Z","2018-03-11T00:00:00.000Z","2018-03-12T00:00:00.000Z","2018-03-13T00:00:00.000Z","2018-03-14T00:00:00.000Z","2018-03-15T00:00:00.000Z","2018-03-16T00:00:00.000Z","2018-03-17T00:00:00.000Z","2018-03-18T00:00:00.000Z","2018-03-19T00:00:00.000Z","2018-03-20T00:00:00.000Z","2018-03-21T00:00:00.000Z","2018-03-22T00:00:00.000Z","2018-03-23T00:00:00.000Z","2018-03-24T00:00:00.000Z","2018-03-25T00:00:00.000Z","2018-03-26T00:00:00.000Z","2018-03-27T00:00:00.000Z","2018-03-28T00:00:00.000Z","2018-03-29T00:00:00.000Z","2018-03-30T00:00:00.000Z","2018-03-31T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-04-02T00:00:00.000Z","2018-04-03T00:00:00.000Z","2018-04-04T00:00:00.000Z","2018-04-05T00:00:00.000Z","2018-04-06T00:00:00.000Z","2018-04-07T00:00:00.000Z","2018-04-08T00:00:00.000Z","2018-04-09T00:00:00.000Z","2018-04-10T00:00:00.000Z","2018-04-11T00:00:00.000Z","2018-04-12T00:00:00.000Z","2018-04-13T00:00:00.000Z","2018-04-14T00:00:00.000Z","2018-04-15T00:00:00.000Z","2018-04-16T00:00:00.000Z","2018-04-17T00:00:00.000Z","2018-04-18T00:00:00.000Z","2018-04-19T00:00:00.000Z","2018-04-20T00:00:00.000Z","2018-04-21T00:00:00.000Z","2018-04-22T00:00:00.000Z","2018-04-23T00:00:00.000Z","2018-04-24T00:00:00.000Z","2018-04-25T00:00:00.000Z","2018-04-26T00:00:00.000Z","2018-04-27T00:00:00.000Z","2018-04-28T00:00:00.000Z","2018-04-29T00:00:00.000Z","2018-04-30T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-05-02T00:00:00.000Z","2018-05-03T00:00:00.000Z","2018-05-04T00:00:00.000Z","2018-05-05T00:00:00.000Z","2018-05-06T00:00:00.000Z","2018-05-07T00:00:00.000Z","2018-05-08T00:00:00.000Z","2018-05-09T00:00:00.000Z","2018-05-10T00:00:00.000Z","2018-05-11T00:00:00.000Z","2018-05-12T00:00:00.000Z","2018-05-13T00:00:00.000Z","2018-05-14T00:00:00.000Z","2018-05-15T00:00:00.000Z","2018-05-16T00:00:00.000Z","2018-05-17T00:00:00.000Z","2018-05-18T00:00:00.000Z","2018-05-19T00:00:00.000Z","2018-05-20T00:00:00.000Z","2018-05-21T00:00:00.000Z","2018-05-22T00:00:00.000Z","2018-05-23T00:00:00.000Z","2018-05-24T00:00:00.000Z","2018-05-25T00:00:00.000Z","2018-05-26T00:00:00.000Z","2018-05-27T00:00:00.000Z","2018-05-28T00:00:00.000Z","2018-05-29T00:00:00.000Z","2018-05-30T00:00:00.000Z","2018-05-31T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-06-02T00:00:00.000Z","2018-06-03T00:00:00.000Z","2018-06-04T00:00:00.000Z","2018-06-05T00:00:00.000Z","2018-06-06T00:00:00.000Z","2018-06-07T00:00:00.000Z","2018-06-08T00:00:00.000Z","2018-06-09T00:00:00.000Z","2018-06-10T00:00:00.000Z","2018-06-11T00:00:00.000Z","2018-06-12T00:00:00.000Z","2018-06-13T00:00:00.000Z","2018-06-14T00:00:00.000Z","2018-06-15T00:00:00.000Z","2018-06-16T00:00:00.000Z","2018-06-17T00:00:00.000Z","2018-06-18T00:00:00.000Z","2018-06-19T00:00:00.000Z","2018-06-20T00:00:00.000Z","2018-06-21T00:00:00.000Z","2018-06-22T00:00:00.000Z","2018-06-23T00:00:00.000Z","2018-06-24T00:00:00.000Z","2018-06-25T00:00:00.000Z","2018-06-26T00:00:00.000Z","2018-06-27T00:00:00.000Z","2018-06-28T00:00:00.000Z","2018-06-29T00:00:00.000Z","2018-06-30T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-07-02T00:00:00.000Z","2018-07-03T00:00:00.000Z","2018-07-04T00:00:00.000Z","2018-07-05T00:00:00.000Z","2018-07-06T00:00:00.000Z","2018-07-07T00:00:00.000Z","2018-07-08T00:00:00.000Z","2018-07-09T00:00:00.000Z","2018-07-10T00:00:00.000Z","2018-07-11T00:00:00.000Z","2018-07-12T00:00:00.000Z","2018-07-13T00:00:00.000Z","2018-07-14T00:00:00.000Z","2018-07-15T00:00:00.000Z","2018-07-16T00:00:00.000Z","2018-07-17T00:00:00.000Z","2018-07-18T00:00:00.000Z","2018-07-19T00:00:00.000Z","2018-07-20T00:00:00.000Z","2018-07-21T00:00:00.000Z","2018-07-22T00:00:00.000Z","2018-07-23T00:00:00.000Z","2018-07-24T00:00:00.000Z","2018-07-25T00:00:00.000Z","2018-07-26T00:00:00.000Z","2018-07-27T00:00:00.000Z","2018-07-28T00:00:00.000Z","2018-07-29T00:00:00.000Z","2018-07-30T00:00:00.000Z","2018-07-31T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-08-02T00:00:00.000Z","2018-08-03T00:00:00.000Z","2018-08-04T00:00:00.000Z","2018-08-05T00:00:00.000Z","2018-08-06T00:00:00.000Z","2018-08-07T00:00:00.000Z","2018-08-08T00:00:00.000Z","2018-08-09T00:00:00.000Z","2018-08-10T00:00:00.000Z","2018-08-11T00:00:00.000Z","2018-08-12T00:00:00.000Z","2018-08-13T00:00:00.000Z","2018-08-14T00:00:00.000Z","2018-08-15T00:00:00.000Z","2018-08-16T00:00:00.000Z","2018-08-17T00:00:00.000Z","2018-08-18T00:00:00.000Z","2018-08-19T00:00:00.000Z","2018-08-20T00:00:00.000Z","2018-08-21T00:00:00.000Z","2018-08-22T00:00:00.000Z","2018-08-23T00:00:00.000Z","2018-08-24T00:00:00.000Z","2018-08-25T00:00:00.000Z","2018-08-26T00:00:00.000Z","2018-08-27T00:00:00.000Z","2018-08-28T00:00:00.000Z","2018-08-29T00:00:00.000Z","2018-08-30T00:00:00.000Z","2018-08-31T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-09-02T00:00:00.000Z","2018-09-03T00:00:00.000Z","2018-09-04T00:00:00.000Z","2018-09-05T00:00:00.000Z","2018-09-06T00:00:00.000Z","2018-09-07T00:00:00.000Z","2018-09-08T00:00:00.000Z","2018-09-09T00:00:00.000Z","2018-09-10T00:00:00.000Z","2018-09-11T00:00:00.000Z","2018-09-12T00:00:00.000Z","2018-09-13T00:00:00.000Z","2018-09-14T00:00:00.000Z","2018-09-15T00:00:00.000Z","2018-09-16T00:00:00.000Z","2018-09-17T00:00:00.000Z","2018-09-18T00:00:00.000Z","2018-09-19T00:00:00.000Z","2018-09-20T00:00:00.000Z","2018-09-21T00:00:00.000Z","2018-09-22T00:00:00.000Z","2018-09-23T00:00:00.000Z","2018-09-24T00:00:00.000Z","2018-09-25T00:00:00.000Z","2018-09-26T00:00:00.000Z","2018-09-27T00:00:00.000Z","2018-09-28T00:00:00.000Z","2018-09-29T00:00:00.000Z","2018-09-30T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-10-02T00:00:00.000Z","2018-10-03T00:00:00.000Z","2018-10-04T00:00:00.000Z","2018-10-05T00:00:00.000Z","2018-10-06T00:00:00.000Z","2018-10-07T00:00:00.000Z","2018-10-08T00:00:00.000Z","2018-10-09T00:00:00.000Z","2018-10-10T00:00:00.000Z","2018-10-11T00:00:00.000Z","2018-10-12T00:00:00.000Z","2018-10-13T00:00:00.000Z","2018-10-14T00:00:00.000Z","2018-10-15T00:00:00.000Z","2018-10-16T00:00:00.000Z","2018-10-17T00:00:00.000Z","2018-10-18T00:00:00.000Z","2018-10-19T00:00:00.000Z","2018-10-20T00:00:00.000Z","2018-10-21T00:00:00.000Z","2018-10-22T00:00:00.000Z","2018-10-23T00:00:00.000Z","2018-10-24T00:00:00.000Z","2018-10-25T00:00:00.000Z","2018-10-26T00:00:00.000Z","2018-10-27T00:00:00.000Z","2018-10-28T00:00:00.000Z","2018-10-29T00:00:00.000Z","2018-10-30T00:00:00.000Z","2018-10-31T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-11-02T00:00:00.000Z","2018-11-03T00:00:00.000Z","2018-11-04T00:00:00.000Z","2018-11-05T00:00:00.000Z","2018-11-06T00:00:00.000Z","2018-11-07T00:00:00.000Z","2018-11-08T00:00:00.000Z","2018-11-09T00:00:00.000Z","2018-11-10T00:00:00.000Z","2018-11-11T00:00:00.000Z","2018-11-12T00:00:00.000Z","2018-11-13T00:00:00.000Z","2018-11-14T00:00:00.000Z","2018-11-15T00:00:00.000Z","2018-11-16T00:00:00.000Z","2018-11-17T00:00:00.000Z","2018-11-18T00:00:00.000Z","2018-11-19T00:00:00.000Z","2018-11-20T00:00:00.000Z","2018-11-21T00:00:00.000Z","2018-11-22T00:00:00.000Z","2018-11-23T00:00:00.000Z","2018-11-24T00:00:00.000Z","2018-11-25T00:00:00.000Z","2018-11-26T00:00:00.000Z","2018-11-27T00:00:00.000Z","2018-11-28T00:00:00.000Z","2018-11-29T00:00:00.000Z","2018-11-30T00:00:00.000Z","2018-12-01T00:00:00.000Z","2018-12-02T00:00:00.000Z","2018-12-03T00:00:00.000Z","2018-12-04T00:00:00.000Z","2018-12-05T00:00:00.000Z","2018-12-06T00:00:00.000Z","2018-12-07T00:00:00.000Z","2018-12-08T00:00:00.000Z","2018-12-09T00:00:00.000Z","2018-12-10T00:00:00.000Z","2018-12-11T00:00:00.000Z","2018-12-12T00:00:00.000Z","2018-12-13T00:00:00.000Z","2018-12-14T00:00:00.000Z","2018-12-15T00:00:00.000Z","2018-12-16T00:00:00.000Z","2018-12-17T00:00:00.000Z","2018-12-18T00:00:00.000Z","2018-12-19T00:00:00.000Z","2018-12-20T00:00:00.000Z","2018-12-21T00:00:00.000Z","2018-12-22T00:00:00.000Z","2018-12-23T00:00:00.000Z","2018-12-24T00:00:00.000Z","2018-12-25T00:00:00.000Z","2018-12-26T00:00:00.000Z","2018-12-27T00:00:00.000Z","2018-12-28T00:00:00.000Z","2018-12-29T00:00:00.000Z","2018-12-30T00:00:00.000Z","2018-12-31T00:00:00.000Z"],[-15.3145971298218,-11.794882774353,-5.52833271026611,-5.23078727722168,-3.47026300430298,-5.07851505279541,4.63778829574585,3.23348784446716,7.75648403167725,7.84487295150757,0.133419454097748,-11.1903257369995,-8.49332523345947,-3.93471384048462,-3.6658627986908,-15.7474613189697,-13.7596426010132,-5.32536268234253,1.0743054151535,7.92436265945435,7.27731227874756,1.76881301403046,1.08820629119873,2.79135036468506,7.69452047348022,11.2569437026978,5.66207790374756,1.68392336368561,-2.76004242897034,2.00891518592834,8.05311965942383,0.641683161258698,-3.45238089561462,4.95351076126099,-2.89379334449768,-10.9612302780151,-8.54846286773682,-7.93834400177002,1.51681292057037,2.75909328460693,-7.28398609161377,-6.24484968185425,-3.56618595123291,2.19293236732483,8.9154224395752,15.7404794692993,3.05527782440186,5.26876878738403,7.42170000076294,6.97590446472168,-3.97133994102478,-6.92618799209595,-2.65100717544556,-0.0431655831634998,0.932597041130066,1.44303798675537,5.26262807846069,12.0039730072021,11.8337917327881,6.28787279129028,7.89253902435303,13.5814599990845,16.1712455749512,12.410496711731,5.57975673675537,2.66071486473083,2.97588515281677,9.3998851776123,10.0686187744141,6.26429891586304,2.86184978485107,5.16631746292114,6.51257371902466,15.6013736724854,16.9879264831543,8.89421463012695,5.90936088562012,5.81464290618896,4.93930864334106,6.09816265106201,11.9020652770996,15.6422243118286,13.1110553741455,6.36161184310913,8.06359672546387,6.97055721282959,6.35757207870483,7.32132863998413,7.61965990066528,12.9080877304077,-0.068727895617485,1.50436305999756,5.63575410842896,2.92296385765076,13.9654159545898,8.22948360443115,-1.99530375003815,2.21101784706116,6.27796316146851,7.72910070419312,17.6040573120117,22.3481884002686,23.9923629760742,2.80889916419983,-0.675887882709503,6.38894176483154,13.6105690002441,14.3231906890869,8.63802719116211,10.8436870574951,9.17960929870605,8.92950344085693,15.0721006393433,14.9982824325562,8.61684417724609,10.7145910263062,14.8825550079346,17.0543270111084,16.7873191833496,21.3952903747559,22.6210136413574,23.4797782897949,19.6254501342773,19.4941482543945,20.3483467102051,22.7432384490967,23.6306476593018,24.9860305786133,24.43088722229,25.2730388641357,25.6553821563721,26.5019569396973,23.4498081207275,26.2664566040039,23.5778770446777,23.6778602600098,25.0892467498779,24.3302993774414,23.180290222168,18.8081359863281,20.9929504394531,25.0419979095459,26.9875583648682,26.219388961792,25.9290809631348,28.0511837005615,28.2846393585205,27.8472480773926,25.2113990783691,23.5366840362549,27.4484462738037,27.8405933380127,26.9370002746582,24.7713928222656,24.1677742004395,26.1846675872803,29.251314163208,26.4751243591309,27.207950592041,29.2447185516357,30.3637523651123,31.4859638214111,29.8621311187744,29.565336227417,30.7392253875732,31.0871410369873,30.506254196167,30.4098930358887,30.4380855560303,28.7996120452881,24.7167663574219,23.8165512084961,23.1334648132324,24.6608562469482,25.7934989929199,23.1687850952148,25.6575489044189,29.9608860015869,30.9861888885498,30.9026927947998,30.7660121917725,26.8892993927002,27.4294815063477,30.667423248291,31.0300731658936,29.1782417297363,28.6379261016846,29.6126041412354,29.0667095184326,29.8345279693604,30.6181945800781,31.4890251159668,33.0383529663086,33.2726135253906,27.5612087249756,31.4773941040039,26.6400661468506,25.225456237793,26.1930065155029,28.5278568267822,28.2981395721436,28.0051574707031,27.3458995819092,27.7934474945068,29.0943183898926,26.938009262085,24.627799987793,25.5083408355713,28.8249988555908,25.4753856658936,22.7600708007812,21.148509979248,24.1836566925049,25.3530979156494,26.7519588470459,26.6702423095703,28.9180526733398,28.5682678222656,26.9802322387695,27.3438739776611,27.1583366394043,28.2091522216797,26.9793071746826,27.0428791046143,24.6734447479248,23.0438938140869,24.4071502685547,25.71946144104,26.1222476959229,26.354024887085,22.2622394561768,19.8908309936523,20.7712593078613,20.1575260162354,20.8178272247314,26.2155742645264,26.240161895752,25.8630447387695,27.1730709075928,26.3848438262939,20.9955959320068,22.9470024108887,26.1916332244873,28.8521213531494,27.1701965332031,24.0055103302002,23.5600509643555,23.8501033782959,21.2521057128906,21.214054107666,18.8692226409912,19.2663917541504,18.8466396331787,19.8207759857178,20.9040203094482,23.456148147583,25.2217483520508,26.13405418396,25.9927921295166,26.9641132354736,27.9698848724365,28.0220012664795,27.4832897186279,21.2954788208008,16.2007865905762,18.0677757263184,21.2172679901123,19.9960994720459,15.3724222183228,15.9932661056519,14.2747783660889,11.3467426300049,20.4215145111084,18.4586925506592,20.6070575714111,26.1349945068359,15.1013040542603,15.607346534729,12.873025894165,10.621470451355,16.7713050842285,14.9630193710327,8.61066722869873,7.6967396736145,9.13297271728516,8.82888793945312,7.22380113601685,2.60426354408264,6.32750463485718,11.1860370635986,12.0971088409424,15.2036142349243,13.2376203536987,11.1228055953979,15.9806690216064,15.4054250717163,12.8352909088135,10.0213098526001,10.7658071517944,13.9140453338623,16.3334426879883,12.7166976928711,14.7048511505127,10.0105848312378,10.1247129440308,9.52361583709717,10.0633726119995,8.69316864013672,9.77338314056396,6.02661943435669,4.68319320678711,1.35189712047577,-2.30079126358032,-6.54697608947754,1.77260363101959,-2.29455161094666,-4.59730243682861,-0.425173193216324,3.25942516326904,5.99219179153442,3.15931224822998,-0.323703527450562,1.27171730995178,3.65040493011475,6.50237560272217,7.65766286849976,12.33469581604,8.96016883850098,3.11033654212952,-1.92784988880157,-4.63240671157837,-2.53982901573181,3.43582439422607,2.4283652305603,4.13082122802734,1.21634829044342,-0.590188086032867,-3.07097554206848,-0.298287451267242,2.02117300033569,-1.99688827991486,-2.71052408218384,-1.90089523792267,-1.23850989341736,1.8205760717392,2.27875161170959,2.69572854042053,2.34608101844788,1.37977373600006,3.48145461082458,3.13271617889404,4.21369695663452,6.67556047439575,5.50712490081787,2.62098336219788,3.6403341293335,2.63127422332764,2.03335356712341,2.69981551170349,7.15615510940552,7.06167650222778,-4.15259790420532,-5.61733484268188,-2.69880795478821,0.492913812398911],[-16.551177639545,-9.57640637518796,-8.78328472780299,-9.998605164769,-15.809321896509,-17.119332669332,-15.476218493729,-0.47102379409796,-0.598555981823949,-4.697317315757,8.26915526270801,7.66527999786302,-9.81625612291998,-14.838230896085,-12.245257716324,-5.49156228626299,-8.58458254652498,-6.56399790988098,-2.756022485686,1.54463320692201,0.544434873942009,3.03950499117605,5.37143330188104,-2.74284434186796,-5.59830179258398,-1.61312380733699,4.98098815358702,2.54956422098701,-0.155644625844957,-5.75582450203598,-10.007499077123,1.94230815646904,-7.190988952515,-6.90435074144597,0.333822649468004,-6.21966220092196,-5.43127297693496,-6.834012800778,-8.152046640121,-7.210876886508,-2.02241754547396,-1.16184074912098,-3.17326265279098,-8.45174694246896,1.00214441176701,5.19300336549202,2.33382834916102,-1.80904588571099,-0.848109923394986,2.20401367440803,12.064986934362,9.61722881042402,0.573788519377047,3.33141294881,5.05762995530603,5.42435871680505,3.75455128423704,4.368606727376,6.98397872850501,3.15652321508401,0.395222927007012,-1.21620270075397,-2.51532612145797,-3.15412683360501,-3.53330239608198,-0.157884540477994,-1.43662966882897,-1.78672847547097,-1.09418951943798,-2.89225193487198,-2.87329397255201,-1.90977967681698,-1.46814944993901,-1.75903832047999,-2.93352371363397,-1.615924559723,-2.35264801020497,-1.81694670714199,-2.89045934882699,-1.07438001562195,0.0383808925110429,0.369243694716999,-0.210707382463966,-0.354703936278952,3.30427896498702,2.33371847600705,5.97932564747902,4.87430875629605,4.34351917591101,3.84756107319902,2.89045740101704,2.41124706977604,2.21593819325204,5.94359949883301,-0.212708695076969,0.689663574548035,-0.642967549719003,-1.07377619557798,0.146696107581022,2.470292006612,2.335897509848,4.985340256999,7.82345166569201,2.04995289086503,-0.0605109365349676,3.82412958547201,1.50333254831003,2.193709435941,1.61723853900003,3.34545804170904,5.134210884509,7.66391990444703,11.316093045882,12.97456619337,9.42491453010501,7.790259409724,9.99406581327599,7.90795386329404,5.548649514641,7.78474240736904,12.282505086986,17.437842157996,17.038009121788,17.766623579228,14.586588829024,16.273704944966,14.049138212367,14.715368719309,17.831864341779,18.328845937552,11.362411958916,10.659898115799,13.529909077992,15.913090034762,16.608685565473,17.27867186378,18.788652014941,15.516096820177,15.987610106243,17.436338545238,16.345314198717,17.528062308069,18.455721836698,18.406294120819,20.10357135094,20.359862954993,21.905761536854,23.701820255943,23.084236432416,24.838362630208,25.143882976847,24.102100178719,20.061338980962,18.195541741762,17.784919605499,15.112679209196,14.107034914363,17.143557759639,19.624579045154,19.177332731856,19.845890155428,19.007007413198,20.952119119241,22.294765034682,20.732822300135,20.254765102094,21.460323499224,24.675374620172,25.430354215643,22.14009645726,19.262755118751,19.932453831041,18.28979451878,19.076015255571,18.95598594362,19.183383110923,19.166082806887,20.0187111790841,21.917277646466,24.147348243893,25.72407051739,27.695484546392,27.610402355619,26.840141460144,27.250698272314,27.048253074694,23.460082316615,22.001903263463,22.865332691961,23.790334920159,25.010033752346,24.062353887612,23.487620386032,26.127264567814,25.881673230978,26.041754763291,27.844776154003,26.043770850752,22.82387853272,22.970920520262,25.352560595539,25.73089259866,21.03235850873,24.17181507025,24.785163872013,24.128502467511,23.923786859809,23.108167755289,21.388963362227,21.347690633706,21.873034217002,23.047519409912,22.980640462885,23.534477687919,24.38178182723,24.722182114201,25.535178018054,26.876932277818,25.110058365193,23.112155662578,23.378714617914,23.579954661707,22.22864190527,22.80317599535,22.118476918505,22.395991224759,24.894123096148,24.864282560923,23.539931463926,22.668218832456,21.177410695041,22.220204648902,21.835597168162,20.334242671476,19.537467310013,21.909972761616,22.680724961863,23.254867943906,24.391425816555,26.342832436878,26.231312323358,21.110015203866,20.346886898128,23.943793569264,25.223850347933,25.225475601178,25.773553457949,27.058744179172,24.620398804274,22.356842471648,17.917082728027,14.385398489553,13.4877931277341,17.760718310276,18.801022355492,21.489822801175,23.612971831105,23.832406593625,23.915831367619,22.820420260072,22.642813183448,19.947034649719,17.713165205931,23.4273356535491,16.736469481433,14.98712279113,16.361927445814,17.690106869985,19.828655295321,14.985322171284,16.501085873606,13.956381681939,12.222522084234,12.13784371735,14.53765172824,15.36817412795,19.214442666141,11.811684313951,15.705824492703,17.281125160925,18.292283931629,22.516795612938,22.780433045742,20.05352935531,11.023136959034,8.15655725958703,9.46920231056004,10.426878234482,7.99463146986403,8.969965520264,4.747057738325,9.21871715745505,10.323404791013,4.749616815428,6.537855622557,7.018498309356,5.056440786189,4.91449002894905,5.77701996526304,3.95011235567705,4.39825984786103,5.69426081407903,6.04825174765301,9.43996169809003,7.32728217629705,6.54271351296603,5.31194478730703,4.38582639862403,8.36800601590903,10.536855856645,8.60394541452803,4.72369732571502,0.854222783780017,1.261505720885,0.677738492752042,1.43206447738504,1.15713073731405,-1.39786207696898,-2.20546292750799,0.591360849113016,1.87743763611502,-0.481133175042999,1.64577141543901,-0.0374984870899766,-0.675270214379964,-6.76648040849398,-6.06008133191398,0.184983572847045,4.75105408114405,2.54357140789602,1.283842230787,-0.0307177259939522,0.36463491050705,-0.420015737488995,0.873281156379051,5.967546505896,4.27521877433503,-0.862704199213965,-3.92290904058598,-0.906837626656966,-4.98441102000396,-5.73462841303296,-5.86435942034797,-3.482904891852,-2.077794909722,-1.61448094558898,0.322572794788016,0.976771474013049,1.18130001887505,0.902766890822022,1.093318756207,-1.81823574415398,-1.01802522487799,0.812292792849007,3.63814439401602,0.183617762644019,-0.16069583254199,0.12395664424804,-1.14005679776596,-1.22865558865999,-1.28970473838098,6.62250466820103,2.02421786769401,-0.817743075018996,-0.548946072369972],[-14.7,-9.9,-9.9,-8.6,-16.2,-17.5,-14.5,-0.6,-0.3,-1.6,10.8,9.7,-10.1,-12.6,-11.3,-5.2,-9.5,-7.9,-2.3,2.9,1.5,4.5,6.9,-4.1,-6.5,-0.1,7.4,3,-0.8,-7,-8.1,2.9,-8.9,-8.2,0.8,-7.3,-7.2,-6.9,-9.2,-7.9,-2.1,-1.6,-3.1,-6.9,1.2,5.6,3.2,-3.9,-1.1,4.1,14.1,11.7,0.6,4.2,3.9,5.3,2.3,3.6,7.6,3.3,-0.1,-0.7,-2.3,-3.1,-1.7,0.1,-1.9,-1.8,-1.2,-2.3,-1.7,-2.1,-1.9,-1.5,-3.3,-2.7,-2,-2.1,-3.3,-1.3,-0.2,-0.4,-1.1,-1.7,3.1,5.1,5.7,7.1,4.4,3.1,2.1,0.6,2.7,5.3,-2.1,-0.4,-2,-1.9,-0.8,0.7,1.8,6.2,6.9,2.6,-0.4,3.2,0.2,1.2,1.2,1.9,3.7,7.4,13.1,14.8,10.3,5.7,9.4,7.1,3.8,6.5,11.7,18.8,16.7,16.4,13.7,16.8,14.7,17.4,21.8,20.3,11.4,12.6,15.1,16.7,19.2,19.7,21.9,18.6,19.8,19,16.4,16.3,14.5,15.9,18.5,20.2,22.7,23.3,24,25.4,25.7,22.9,18.6,18.2,16.8,14.3,12.4,15.1,19.2,18.9,20,18.8,20.2,21.9,20.7,18.8,20.6,23.8,25.1,20.9,19.6,18.7,18,19.8,19.1,18.1,18.6,21.7,21.4,22.9,25.1,27.4,27.6,26.6,27,27.5,23.1,19.8,21.9,23,24.6,23.1,22.2,25.6,24.8,24.8,26.4,25.2,21.5,20.9,24.7,24.9,20,24.6,25.6,23.4,23.5,22.3,20.7,20.7,20.9,22.5,23.7,23.3,23.9,23.6,23.8,26.4,24.4,22.4,22.9,22.8,20.9,21.9,21.5,22.5,23.9,24.4,23.8,21.4,20.1,21.4,22.2,20.7,18.5,20.9,22.6,22.9,24.1,26.9,26.6,20.5,19.6,23.2,24.3,24.9,25,27.1,24.2,21.1,16.9,12.5,13.4,17.3,19.1,21.8,24.5,24.2,24.5,22.4,21.9,18.9,17.3,24.6,15.7,13.3,15.3,18.1,20.6,13.4,15.6,13.3,11.7,11.8,14.9,14.3,19.7,10.3,16,16.8,16.6,24.2,23.2,20.6,9.3,7,9.1,10.4,6.4,8.8,3.6,9.1,9.9,3.7,5.9,6.1,4.7,3.9,5,4,3.5,5.5,5.3,10.4,7.8,6.9,4.8,4.6,9.9,11.4,8.6,4.7,1.9,0.7,0.2,2.6,2.2,-1.8,-2.2,0.3,2.2,0.1,1.7,0.1,-1.8,-9,-5.9,1.4,6.4,4.9,1.2,-0.6,-0.2,-0.3,0.8,7.3,5,-1.8,-4.1,-0.7,-4.4,-4.5,-3,-1.8,-1.8,-1.1,1.4,3.4,3.6,2.1,2.1,-1.7,-0.6,3.2,5.2,-0.1,-0.2,0.7,-0.8,0.1,-1.1,9.2,1.9,-1.8,0.2]],"fixedtz":false,"tzone":"UTC"},"evals":["attrs.interactionModel"],"jsHooks":[]}</script>
<div id="difference-between-hrrr-and-era5---monthly-average-temperature" class="section level3">
<h3>Difference between HRRR and ERA5 - Monthly Average Temperature</h3>
<pre class="r"><code># rasters of difference between HRRR and ERA5 (3x12)
ls_names=c(&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;)

monthly_mean_Diff_brick=brick(monthly_mean_Diff)
names(monthly_mean_Diff_brick)=ls_names
levelplot(mask(monthly_mean_Diff_brick,ny_bound),
          col.regions=viridis)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
<pre class="r"><code># gplot(mask(monthly_mean_Diff_brick,ny_bound))+
#   geom_tile( aes( fill=value ) )+
#   scale_fill_continuous(type=&#39;viridis&#39;,name=&quot;Temperature&quot;)+
#   xlab(NULL)+
#   ylab(NULL)+
#   facet_wrap(~ variable)
# plot(mask(monthly_mean_Diff_brick,ny_bound),nr=4)</code></pre>
</div>
<div id="difference-between-hrrr-and-era5---monthly-minimum-temperature" class="section level3">
<h3>Difference between HRRR and ERA5 - Monthly Minimum Temperature</h3>
<pre class="r"><code>monthly_min_Diff_brick=brick(monthly_min_Diff)
names(monthly_min_Diff_brick)=ls_names
levelplot(mask(monthly_min_Diff_brick,ny_bound),
          col.regions=viridis)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
</div>
<div id="difference-between-hrrr-and-era5---monthly-maximum-temperature" class="section level3">
<h3>Difference between HRRR and ERA5 - Monthly Maximum Temperature</h3>
<pre class="r"><code>monthly_max_Diff_brick=brick(monthly_max_Diff)
names(monthly_max_Diff_brick)=ls_names
levelplot(mask(monthly_min_Diff_brick,ny_bound),
          col.regions=viridis)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>In progress…</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
</div>

<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  This website is a project for Adam Wilson's <a href="https://wilsonlab.io/GEO511"><i> Spatial Data Science (GEO511) </i></a>Course at the University at Buffalo
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
